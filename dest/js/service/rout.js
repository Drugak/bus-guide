BUS.router=function(){var e=this;this.routes={},this.disabledRoutes={},this.history=window.history,this.reseted=!1,this.clearHash=function(e){return e.replace(/#/g,"")},this.clearSlashes=function(e){return e.toString().replace(/\/$/,"").replace(/^\//,"")},this.parseQuery=function(e){var r={},t=e?e:location.search;return t.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,t,s,n){r[t]=n}),r};var r=this.clearHash(location.hash);return this.match=function(r){var t=e.clearHash(location.hash);t=e.clearSlashes(t);var s=t.split("?");if(e.routes.hasOwnProperty(s.first())){if(!r)return{query:s[1]?e.parseQuery(s.last()):null};e.routes[s.first()].forEach(function(r){r({query:s[1]?e.parseQuery(s.last()):null})})}else{var n,a,o,i,u=Object.keys(e.routes),c=u.length,l=s.first()+"/",h={};for(i=0;c>i;i++)if(n=u[i],a=n.match(/:([^\/]+)/g),o=l.match(new RegExp(n.replace(/:[^\s/]+/g,"([\\w-]+)")+"+[^]$"))){if(o.shift(),a=a.map(function(e){return e.replace(":","")}),o.forEach(function(e,r){h[a[r]]=e}),!r)return{parameters:h,query:s[1]?e.parseQuery(s.last()):null};e.routes[n].forEach(function(r){r({parameters:h,query:s[1]?e.parseQuery(s.last()):null})});break}}return!1},this.check=function(r){if(e.reseted)e.reseted=!1;else{if(r&&e.clearSlashes(r.oldURL)===e.clearSlashes(r.newURL))return console.log("OldURl and NewURL is equal"),!1;e.match(!0)}},{on:function(r){var t=arguments[1];return r=e.clearSlashes(r),t?e.routes.hasOwnProperty(r)?e.routes[r].push(t):e.routes[r]=[t]:e.disabledRoutes.hasOwnProperty(r)?(e.routes[r]=e.disabledRoutes[r],delete e.disabledRoutes[r]):console.warn("Route "+r+" missing"),this},off:function(r){return r=e.clearSlashes(r),e.disabledRoutes[r]=e.routes[r],delete e.routes[r],this},routes:e.routes,disabledRoutes:e.disabledRoutes,resetOnReload:function(t){return t=Array.isArray(t)?t:[],-1!==t.indexOf(r)&&(location.hash="",e.reseted=!0),this},reset:function(){return e.routes={},window.location.href="",this},listen:function(){return console.log("Route changes listening"),window.addEventListener("hashchange",e.check,!1),this},check:function(){e.check.call()},back:function(){return console.log("History back"),history.back(),this},forward:function(){return history.forward(),this},reload:function(){location.reload(!0)},get:function(){return e.match(!1)},set:function(r){return"string"==typeof r&&(location.hash="/"+e.clearSlashes(r)),this}}};