function Router(){var e=this;this.routes={},this.disabledRoutes={},this.history=window.history,this.reseted=!1,this.clearHash=function(e){return e.replace(/#/g,"")},this.clearSlashes=function(e){return e.toString().replace(/\/$/,"").replace(/^\//,"")},this.parseQuery=function(e){var t={},r=e?e:location.search;return r.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,r,s,n){t[r]=n}),t};var t=this.clearHash(location.hash);return this.match=function(t){var r=e.clearHash(location.hash);r=e.clearSlashes(r);var s=r.split("?");if(e.routes.hasOwnProperty(s.first())){if(!t)return{query:s[1]?e.parseQuery(s.last()):null};e.routes[s.first()].forEach(function(t){t({query:s[1]?e.parseQuery(s.last()):null})})}else{var n,o,a,i,u=Object.keys(e.routes),l=u.length,c=s.first()+"/",h={};for(i=0;l>i;i++)if(n=u[i],o=n.match(/:([^\/]+)/g),a=c.match(new RegExp(n.replace(/:[^\s\/]+/g,"([\\w-]+)")+"+[^]$"))){if(a.shift(),o=o.map(function(e){return e.replace(":","")}),a.forEach(function(e,t){h[o[t]]=e}),!t)return{parameters:h,query:s[1]?e.parseQuery(s.last()):null};e.routes[n].forEach(function(t){t({parameters:h,query:s[1]?e.parseQuery(s.last()):null})});break}}return!1},this.check=function(t){if(e.reseted)e.reseted=!1;else{if(t&&e.clearSlashes(t.oldURL)===e.clearSlashes(t.newURL))return console.log("OldURl and NewURL is equal"),!1;e.match(!0)}},{test:function(){console.log("flsadhjflsdfllakfjlds")},on:function(t){var r=arguments[1];return t=e.clearSlashes(t),r?e.routes.hasOwnProperty(t)?e.routes[t].push(r):e.routes[t]=[r]:e.disabledRoutes.hasOwnProperty(t)?(e.routes[t]=e.disabledRoutes[t],delete e.disabledRoutes[t]):console.warn("Route "+t+" missing"),this},off:function(t){return t=e.clearSlashes(t),e.disabledRoutes[t]=e.routes[t],delete e.routes[t],this},routes:e.routes,disabledRoutes:e.disabledRoutes,resetOnReload:function(r){return r=Array.isArray(r)?r:[],-1!==r.indexOf(t)&&(location.hash="",e.reseted=!0),this},reset:function(){return e.routes={},window.location.href="",this},listen:function(){return console.log("Route changes listening"),window.addEventListener("hashchange",e.check,!1),this},check:function(){e.check.call()},back:function(){return console.log("History back"),history.back(),this},forward:function(){return history.forward(),this},reload:function(){location.reload(!0)},get:function(){return e.match(!1)},set:function(t){return"string"==typeof t&&(location.hash="/"+e.clearSlashes(t)),this},setPage:function(e){return"string"==typeof e?window.location.href=e:console.error("Иди в пизду!! это не урл"),this}}}BUS.router=new Router;